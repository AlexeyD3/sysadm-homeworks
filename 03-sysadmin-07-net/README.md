# Домашнее задание к занятию "3.7. Компьютерные сети.Лекция 2"

### Цель задания

В результате выполнения этого задания вы:

1. Познакомитесь с инструментами настройки сети в Linux, агрегации нескольких сетевых интерфейсов, отладки их работы.
2. Примените знания о сетевых адресах на практике для проектирования сети.


### Инструкция к заданию

1. Создайте .md-файл для ответов на задания в своём репозитории, после выполнения прикрепите ссылку на него в личном кабинете.
2. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.


### Инструменты/ дополнительные материалы, которые пригодятся для выполнения задания

1. [Калькулятор сетей online](https://calculator.net/ip-subnet-calculator.html).
2. Калькулятор сетей программа - ipcalc (`apt install ipcalc`), если есть графический интерфейс, то у программы калькулятора есть инженерный режим, там можно и сети считать.


------

## Задание

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?
```bash
wolin@wolinubuntu:~$ ip link show
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: enp4s0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether 44:8a:5b:ef:aa:1a brd ff:ff:ff:ff:ff:ff
3: wlp5s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP mode DORMANT group default qlen 1000
    link/ether 40:e2:30:0e:06:15 brd ff:ff:ff:ff:ff:ff
wolin@wolinubuntu:~$ ifconfig -a
enp4s0: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500
        ether 44:8a:5b:ef:aa:1a  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
        device interrupt 19  

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 108362  bytes 7429442 (7.4 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 108362  bytes 7429442 (7.4 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

wlp5s0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.1.118  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 fe80::2cb4:bcb8:eef6:7d8b  prefixlen 64  scopeid 0x20<link>
        ether 40:e2:30:0e:06:15  txqueuelen 1000  (Ethernet)
        RX packets 1668957  bytes 1855636822 (1.8 GB)
        RX errors 0  dropped 3398  overruns 0  frame 0
        TX packets 649577  bytes 124645778 (124.6 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```
Для виндовс: ipconfig

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?
```bash
wolin@wolinubuntu:~$ lldpctl
-------------------------------------------------------------------------------
LLDP neighbors:
-------------------------------------------------------------------------------
```

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

Virtual LAN
vlan
пример конфига:
```bash
auto vlan1400
iface vlan1400 inet static
        address 192.168.1.1
        netmask 255.255.255.0
        vlan_raw_device eth0
```

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

```bash
Типы LAG: статический, динамический и ручной.
Опции балансировки нагрузки зависят от используемой платформы агрегации.

Active-backup – режим резервирования. В этом режиме один сетевой интерфейс активный, а второй в режиме ожидания. Когда основной выходит из строя, второй принимает работу на себя. Таким образом обеспечивается стабильный доступ.

Balance-rr – пакеты отправляются последовательно. Этот режим применяется для балансировки нагрузки и отказоустойчивости.

802.3ad – при таком режиме задействуются сразу все сетевые карты. (этот режим должен поддерживаться и на коммутаторе)

Balance-xor – режим применяется для отказоустойчивости и балансировки. Одна и та же сетевая карта передает пакеты одним и тем же получателям

Broadcast – этот режим передает все пакеты на все сетевые карты.

Balance-tlb – режим адаптивной балансировки передачи. Исходящий трафик распределяется в зависимости от загруженности каждой сетевой карты (определяется скоростью загрузки). Не требует дополнительной настройки на коммутаторе. Входящий трафик приходит на текущую сетевую карту. Если она выходит из строя, то другая сетевая карта берёт себе MAC адрес вышедшей из строя карты.

Balance-alb режим адаптивной балансировки нагрузки. Включает в себя политику balance-tlb плюс осуществляет балансировку входящего трафика. Не требует дополнительной настройки на коммутаторе. Балансировка входящего трафика достигается путём ARP переговоров. Драйвер bonding перехватывает ARP ответы, отправляемые с локальных сетевых карт наружу, и переписывает MAC адрес источника на один из уникальных MAC адресов сетевой карты, участвующей в объединении. Таким образом различные пиры используют различные MAC адреса сервера. Балансировка входящего трафика распределяется последовательно (round-robin) между интерфейсами.

пример конфига:

auto bond0

iface bond0 inet static
    address 10.31.1.5
    netmask 255.255.255.0
    network 10.31.1.0
    gateway 10.31.1.254
    bond-slaves eth0 eth1
    bond-mode active-backup
    bond-miimon 100
    bond-downdelay 200
    bond-updelay 200
```

5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.
```bash
всего 8 адресов из них 6 узловых, 1 адрес сети и 1 широковещательный адрес
из сети с маской /24 (256 адресов) можно получить 32 подсети с маской /29 (по 8 адресов каждая)

примеры /29 подсетей внутри сети 10.10.10.0/24

Номер подсети и префикс: 10.10.10.1/29
Маска подсети: 255.255.255.248
Широковещательный адрес: 10.10.10.8
Адрес первого узла: 10.10.10.2
Адрес последнего узла: 10.10.10.7
Диапазон адресов: с 10.10.10.2 до 10.10.10.7

Номер подсети и префикс: 10.10.10.9/29
Маска подсети: 255.255.255.248
Широковещательный адрес: 10.10.10.16
Адрес первого узла: 10.10.10.10
Адрес последнего узла: 10.10.10.15
Диапазон адресов: с 10.10.10.10 до 10.10.10.15

```

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.
```bash
Можно использовать зарезервированные Carrier-Grade NAT адреса, маска /26 подходит под условия и позволит подключить до 62 хостов. 

wolin@wolinubuntu:~$ ipcalc -b 100.64.0.0/10 -s 50
Address:   100.64.0.0           
Netmask:   255.192.0.0 = 10     
Wildcard:  0.63.255.255         
=>
Network:   100.64.0.0/10        
HostMin:   100.64.0.1           
HostMax:   100.127.255.254      
Broadcast: 100.127.255.255      
Hosts/Net: 4194302               Class A

1. Requested size: 50 hosts
Netmask:   255.255.255.224 = 27 
Network:   100.64.0.0/27        
HostMin:   100.64.0.1           
HostMax:   100.64.0.30          
Broadcast: 100.64.0.31          
Hosts/Net: 30                    Class A

Needed size:  64 addresses.
Used network: 100.64.0.0/26
```

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?
```bash
Для Linux:
проверить таблицу:
ip neigh, arp -n
 
очистить кеш:
ip neigh flush
 
удалить один нужный IP:
ip neigh delete <IP> dev <INTERFACE>, arp -d <IP>

Для Windows:
проверить таблицу:
arp -a

очистить кеш:
arp -d (или netsh interface IP delete arpcache)

удалить один нужный IP:
arp -d <IP>
```

*В качестве решения ответьте на вопросы и опишите, каким образом эти ответы были получены*

---

## Задание для самостоятельной отработки* (необязательно к выполнению)

 8. Установите эмулятор EVE-ng.
 
 [Инструкция по установке](https://github.com/svmyasnikov/eve-ng)

 Выполните задания на lldp, vlan, bonding в эмуляторе EVE-ng. 
 
----

### Правила приема домашнего задания

В личном кабинете отправлена ссылка на .md файл в вашем репозитории.


### Критерии оценки

Зачет - выполнены все задания, ответы даны в развернутой форме, приложены соответствующие скриншоты и файлы проекта, в выполненных заданиях нет противоречий и нарушения логики.

На доработку - задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки. 
 
Обязательными к выполнению являются задачи без указания звездочки. Их выполнение необходимо для получения зачета и диплома о профессиональной переподготовке.
Задачи со звездочкой (*) являются дополнительными задачами и/или задачами повышенной сложности. Они не являются обязательными к выполнению, но помогут вам глубже понять тему.
